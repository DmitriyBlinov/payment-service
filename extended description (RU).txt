ТЕСТОВОЕ ЗАДАНИЕ НА СОИСКАТЕЛЯ JAVA DEVELOPER

ОБЩЕЕ ОПИСАНИЕ
Требуется разработать приложение, которое представляет сервис работы с данными в БД. На основании аргументов из терминала, операции и имени input файла сервис должен извлекать данные из БД, преобразовывая результат обработки в output файл. 
Все ошибки обязательно должны быть зафиксированы и обработаны в output-файле.
Стек: PostgreSQL, Java 8, Maven

СТРУКТУРА ДАННЫХ
Товары (name, price)
Покупатели (name, last_name)
Покупки (customer, item, date_of_purchase)

ТИПЫ И ОПИСАНИЕ ОПЕРАЦИЙ
Приложение принимает два типа операций: поиск по критериям (search) или статистика за определенный период (stat)

Поиск по критериям
Input-файл содержит критерии поиска customer. Output-файл – список customer соответственно критериям. Списки должны быть отсортированы согласно расположению критериев в запросе, покупатели – на усмотрение разработчика
Критерии: 
1) Поиск покупателей по фамилии (передается last_name)
2) Поиск покупателей по интервалу, который содержит минимальное и максимальное количество покупок
3) Поиск покупателей по имени товара и кол-ву покупок данного товара равному или превышающему количество, переданное в критерии
4) Поиск покупателей по минимальному количеству купленного товара (должно вернуть кол-во покупателей, переданное в критерии)

Предусмотреть дублирование критериев.

Статистика за определенный период
Input-файл содержит период аккумулирования статистики. Output-файл – выдает статистику за две даты включительно (нерабочие дни можно учесть как рабочие), при наличии ошибки выдает 